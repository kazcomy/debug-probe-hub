version: '3.8'

services:
  # Standard ARM tools container (OpenOCD, J-Link)
  debug-box-std:
    build:
      context: ./docker/standard
      dockerfile: Dockerfile
    image: debugger-station-std:latest
    container_name: debug-box-std
    privileged: true
    volumes:
      - /dev:/dev
      - /tmp/flash_staging:/work
      - ./config.yml:/config.yml:ro
    command: sleep infinity
    network_mode: host
    restart: unless-stopped

  # ESP32 tools container (OpenOCD-ESP32)
  debug-box-esp:
    build:
      context: ./docker/esp32
      dockerfile: Dockerfile
    image: debugger-station-esp:latest
    container_name: debug-box-esp
    privileged: true
    volumes:
      - /dev:/dev
      - /tmp/flash_staging:/work
      - ./config.yml:/config.yml:ro
    command: sleep infinity
    network_mode: host
    restart: unless-stopped

  # WCH RISC-V tools container (minichlink)
  debug-box-wch:
    build:
      context: ./docker/wch
      dockerfile: Dockerfile
    image: debugger-station-wch:latest
    container_name: debug-box-wch
    privileged: true
    volumes:
      - /dev:/dev
      - /tmp/flash_staging:/work
      - ./config.yml:/config.yml:ro
    command: sleep infinity
    network_mode: host
    restart: unless-stopped
